<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>City Navigation System</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <style>
      #map { height: 480px; }
      body { font-family: Arial, sans-serif; margin: 20px; }
      .controls { margin-bottom: 12px; }
    </style>
  </head>
  <body>
    <h2>City Navigation System</h2>
    <div class="controls">
      <form method="post" action="{{ url_for('route') }}">
        <label>Source: <select name="source">
          {% for c in cities %}
            <option value="{{ c.id }}">{{ c.id }} - {{ c.name }}</option>
          {% endfor %}
        </select></label>
        <label>Destination: <select name="destination">
          {% for c in cities %}
            <option value="{{ c.id }}">{{ c.id }} - {{ c.name }}</option>
          {% endfor %}
        </select></label>
        <label>Algorithm:
          <select name="algorithm">
            <option value="dijkstra">Dijkstra</option>
            <option value="astar">A*</option>
          </select>
        </label>
        <button type="submit">Find Route</button>
      </form>
    </div>
    <div id="map"></div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>
      const cities = {{ cities|tojson }};
      const map = L.map('map').setView([28.61,77.20], 11);
      L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        maxZoom: 18,
      }).addTo(map);
      for (const c of cities) {
        if (c.lat && c.lon) {
          L.marker([c.lat, c.lon]).addTo(map).bindPopup(c.id + ' - ' + c.name);
        }
      }
    </script>
  </body>
</html>